!function(){"use strict";function t(t,n){var a=this;a.tripName=t.tripName,a.stops=[],a.organizations=[],a.jobTitles=[],a.errorMessage="",a.isBusy=!0,a.newStop={};var i="/api/organizations";n.get(i).then(function(t){angular.copy(t.data,a.organizations),a.organizations.sort(function(t,o){var n=t.name.toLowerCase(),a=o.name.toLowerCase();return n>a?1:a>n?-1:0});for(var o={},n=0,i=a.organizations.length;i>n;n++)o[a.organizations[n].name]=a.organizations[n];a.organizations=new Array;for(var e in o)a.organizations.push(o[e])},function(t){a.errorMessage="Failed to load organizations"})["finally"](function(){a.isBusy=!1}),i="/api/jobtitles",n.get(i).then(function(t){angular.copy(t.data,a.jobTitles),a.jobTitles.sort(function(t,o){var n=t.name.toLowerCase(),a=o.name.toLowerCase();return n>a?1:a>n?-1:0});for(var o={},n=0,i=a.jobTitles.length;i>n;n++)o[a.jobTitles[n].name]=a.jobTitles[n];a.jobTitles=new Array;for(var e in o)a.jobTitles.push(o[e])},function(t){a.errorMessage="Failed to load job titles"})["finally"](function(){a.isBusy=!1}),i="/api/trips/"+a.tripName+"/stops",n.get(i).then(function(t){angular.copy(t.data,a.stops),o(a.stops)},function(t){a.errorMessage="Failed to load stops"})["finally"](function(){a.isBusy=!1}),a.addStop=function(){a.newStop.order=a.stops.length+1,a.isBusy=!0,n.post(i,a.newStop).then(function(t){a.stops.push(t.data),o(a.stops),a.newStop={}},function(t){a.errorMessage="Failed to add new stops"})["finally"](function(){a.isBusy=!1})}}function o(t){if(t&&t.length>0){var o=_.map(t,function(t){return{lat:t.latitude,"long":t.longitude,info:t.name}});travelMap.createMap({stops:o,selector:"#map",currentStop:0,initialZoom:3})}}t.$inject=["$routeParams","$http"],angular.module("app-trips").controller("tripEditorController",t)}();